<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PremierFix - Maintenance Tracker</title>
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABDVJREFUWEe9V21oXEUUPefNJtVWa6tNbIz9oRRbP8AP/FD8gB+gVhRFReyPglYqKoIIoqhYqdCKVkXEKkJVUBT8UUHxq1VQUasgVkFQqW2TxibZ3ffmHplN3u7Om7dvX7KbHFh2d+bMnXPvnTNzZ4mKxvkA7gJwIYAhAEcA7APwBYBvAUyVGaKMUQPAegD3AljVw84UgF0AngXwflE/RQFcDuBVAMeVcPoLgJcA7AHwG4C/Acw3bU8GcAqAMwBcCeBGACcWOH8dwM0AvutrAIcDeAnADQC+B/AygLcAfJvj4DgA5wG4GcDVAI4E8CKAL5JnZwF4B8AxAK4D8G5vALEEXwO4HMBzAB7KcZoO+xCAhwEcAvAAgCcT+4sAvA3gdADXAvigPwANwNUAXgPwRIGjdQAeA3AAwEYALyT25wN4A8ClAK4B8NEAAFYBeBfAEwXOHgXwIICDAO4H8FRifxGAtwBcDuAKAB8PAMByAO8BeLLA2WYA9wE4AOBJAE8n9hcDeB3AVQA2APh0AABLAbwP4OkCZ1sBbAJwEMBWAM8k9pcAeA3A9QBuAPDZAABOBLAXwDMFzrYD2AzgXwDbADyb2C8B8AqAmwDcCuDzAQAcD+ADAL0S0Q4AWwD8A+BZAC8k9ksBvAzgdgB3Aviy3wQsA/AhgOcLnO0EcA+AfwE8D+DFxH4ZgJcA3AXgbgBfDQBgKYCPALxU4OxVAHcD+BvAiwB2JfbLAbwI4B4A9wH4egAAJwD4GMArBc52A7gTwF8AdgJ4ObE/CcDzAO4H8ACAb/oBEKXgEwCvFjh7HcAdAP4E8AqA1xL7kwE8C2ArgIcBfNcPgOUAPgXwRoGzPQBuA/AHgNcBvJXYrwDwDIBHADwK4Id+AKwA8BmANwucvQngVgC/A3gLwDuJ/UoATwF4DMDjAH7sB8ApAD4H8HaBs7cB3ALgNwB7AbyX2K8C8ASAJQA+ArABwM8DAFgJ4AsA7xQ42wfgZgC/AngXwPuJ/WoA2wGcC2AUwIUAfu0HwGkAvgTwXoGz9wDcCOAXAPsB7E/s1wDYBmAjgFEApwM41A+A0wF8DWBfgbMPAFwP4GcAHwL4OLFfC+BRAJsBjAE4E8C//QA4E8A3AD4pcPYRgOsA/ATgYwCfJvZnA3gYwL0AxgGcA+D/fgCcA+BbAJ8VOPsUwDoAPwL4BMBnif06AA8BmAAwAeD8QQCcB+A7AF8UOPscwFoAPwD4HMCXif35ALYC2AZgEsCFgwC4AMD3AL4qcPYlgMsA/ADgKwBfJ/YXAdgC4CEAUwAuHgTAxQAOAPiuwNk3AC4F8D2ArwB8k9hfAmATgEcATAO4bBAAlwL4AcD3Bc6+A3AJgO8AfAPg28T+MgAbATwOYAbA5YMAWAPgRwA/FTj7HsDFAA4A+BHAwcT+CgDrATwJYBbAlYMAWAvgZwC/FDj7CcBFAH5tDvZrYn8VgHUAngIwB+DqQQD8ARVhw8em0kDrAAAAAElFTkSuQmCC">
    <meta name="theme-color" content="#511e58">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/mobile-responsive.css">
    <link rel="stylesheet" href="css/modern-cards.css"> <!-- Link to new CSS file -->
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Choices.js CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"/>
    
    <style>
        :root {
            --primary: #511e58;
            --secondary: #8e44ad;
            --success: #27ae60;
            --info: #3498db;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #f8f9fa;
            --dark: #343a40;
            --text: #212529;
            --border: #dee2e6;
            --shadow: rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text);
            background-color: #f9f9f9;
            line-height: 1.6;
            font-size: 1rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        .loading-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .loading-container.active {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(81, 30, 88, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        /* Notification container */
        .notification-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1001;
            padding: 10px;
        }
        
        .notification {
            background-color: #fff;
            border-radius: 4px;
            padding: 10px;
            box-shadow: 0 2px 4px var(--shadow);
            margin-bottom: 10px;
        }
        
        .notification.success {
            background-color: #d1e7dd;
            border-left: 4px solid #0f5132;
        }
        
        .notification.error {
            background-color: #f8d7da;
            border-left: 4px solid #842029;
        }
        
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .notification-title {
            font-weight: 600;
            font-size: 1.2rem;
            color: var(--dark);
        }
        
        .notification-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--dark);
            cursor: pointer;
        }
        
        .notification-content {
            color: var(--dark);
            font-size: 0.9rem;
        }
        
        /* Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            margin-top: 20px; /* Add space above dashboard */
            position: relative; /* Establish stacking context */
            z-index: 1; /* Lower z-index than selector */
        }
        
        .maintenance-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px var(--shadow);
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex; /* Added */
            flex-direction: column; /* Added */
            height: 100%; /* Added */
        }
        
        .maintenance-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px var(--shadow);
        }
        
        .maintenance-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .maintenance-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .maintenance-title {
            margin: 0;
            font-size: 1.2rem;
            color: var(--dark);
        }
        
        .maintenance-status {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-weight: 600;
            margin: 10px 0;
        }
        
        .maintenance-status.unknown {
            background-color: #e9ecef;
            color: #495057;
        }
        
        .maintenance-status.completed {
            background-color: #d1e7dd;
            color: #0f5132;
        }
        
        .maintenance-status.due {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .maintenance-status.overdue {
            background-color: #f8d7da;
            color: #842029;
        }
        
        .maintenance-date {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 15px;
        }
        
        .maintenance-action {
            border: none;
            background-color: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .maintenance-action:hover {
            background-color: var(--secondary);
        }
        
        .maintenance-action:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        /* Filter section */
        .filter-section {
            position: absolute; /* Position it absolutely */
            top: 100%; /* Place it below the buttons */
            left: 0;
            right: 0;
            width: 100%;
            z-index: 5; /* Below buttons but above other content */
            margin-top: 5px; /* Small gap below buttons */
            max-height: 0;
            padding: 0;
            overflow: hidden;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #ffffff 0%, #f8f8ff 100%);
            border: 1px solid rgba(81, 30, 88, 0.08);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            visibility: hidden;
            opacity: 0;
        }
        
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            width: 100%;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
        }
        
        .filter-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .filter-input {
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .filter-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(81, 30, 88, 0.1);
        }
        
        .sort-buttons {
            display: flex;
            gap: 10px;
        }
        
        .sort-btn {
            padding: 8px 12px;
            background-color: var(--light);
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .sort-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .clear-filters-btn {
            padding: 8px 10px;
            background-color: var(--light);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--danger);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .clear-filters-btn:hover {
            background-color: #fff5f5;
            border-color: var(--danger);
        }
        
        /* Issues list */
        .issues-list {
            margin-bottom: 40px;
        }
        
        .status-section {
            margin-bottom: 40px;
            position: relative;
        }
        
        .status-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
            padding-left: 15px;
        }
        
        .status-header::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 25px;
            border-radius: 3px;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
        }
        
        .status-header h3 {
            font-size: 1.3rem;
            margin: 0;
            color: var(--dark);
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .issue-count {
            margin-left: 12px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-radius: 20px;
            padding: 3px 12px;
            font-size: 0.8rem;
            font-weight: 600;
            box-shadow: 0 3px 8px rgba(81, 30, 88, 0.2);
        }
        
        .issues-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }
        
        .issue-card {
            background: white;
            border-radius: 16px;
            padding: 0;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.04);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(222, 226, 230, 0.3);
            transform-origin: center bottom;
        }
        
        .issue-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(to right, #e0e0e0, #f0f0f0);
            z-index: 2;
            transition: all 0.4s ease;
        }
        
        .issue-card.priority-low::before {
            background: linear-gradient(to right, #28a745, #75d191);
        }
        
        .issue-card.priority-medium::before {
            background: linear-gradient(to right, #ffc107, #ffe083);
        }
        
        .issue-card.priority-critical::before {
            background: linear-gradient(to right, #dc3545, #f27c87);
        }
        
        .issue-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0;
            background: linear-gradient(to top, rgba(81, 30, 88, 0.02), transparent);
            transition: all 0.4s ease;
            z-index: -1;
        }
        
        .issue-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.08);
        }
        
        .issue-card:hover::after {
            height: 100%;
        }
        
        .issue-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 20px 20px 10px;
        }
        
        .issue-location {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--dark);
            margin-right: 15px;
        }
        
        .issue-date {
            color: #6c757d;
            font-size: 0.85rem;
            background-color: #f8f9fa;
            padding: 4px 10px;
            border-radius: 20px;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
        }
        
        .issue-date i {
            color: var(--primary);
            font-size: 0.8rem;
        }
        
        .issue-content {
            flex: 1;
            padding: 10px 20px 20px;
            position: relative;
        }
        
        .issue-category {
            display: inline-flex;
            align-items: center;
            background: #f0f7ff;
            color: #0062cc;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 4px rgba(0, 98, 204, 0.1);
        }
        
        .issue-category.Electrical {
            background: #f0f7ff;
            color: #0062cc;
        }
        
        .issue-category.Plumbing {
            background: #e6f7ff;
            color: #0095ff;
        }
        
        .issue-category.Furniture {
            background: #fff8e6;
            color: #d68c00;
        }
        
        .issue-category.Other {
            background: #f0f0f0;
            color: #5a5a5a;
        }
        
        .issue-category::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: currentColor;
            margin-right: 8px;
        }
        
        .issue-description {
            margin-bottom: 20px;
            line-height: 1.6;
            color: #4a4a4a;
            font-size: 0.95rem;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            max-width: 100%;
            max-height: 150px;
            overflow-y: auto;
            padding: 12px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 3px solid var(--primary);
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.05);
            
            /* IE and Edge */
            -ms-overflow-style: none;
            
            /* Firefox */
            scrollbar-width: thin;
            scrollbar-color: rgba(81, 30, 88, 0.3) #f1f1f1;
        }
        
        /* Hide scrollbar for Chrome, Safari and Opera */
        .issue-description::-webkit-scrollbar {
            width: 6px;
        }
        
        .issue-description::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .issue-description::-webkit-scrollbar-thumb {
            background: rgba(81, 30, 88, 0.3);
            border-radius: 10px;
        }
        
        .issue-description::-webkit-scrollbar-thumb:hover {
            background: rgba(81, 30, 88, 0.5);
        }
        
        .issue-description p {
            margin: 0 0 10px 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
        }
        
        .issue-photo {
            position: relative;
            margin-top: 15px;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .issue-photo img {
            max-width: 100%;
            border-radius: 12px;
            transition: transform 0.5s ease;
            display: block;
        }
        
        .issue-photo:hover img {
            transform: scale(1.05);
        }
        
        .view-photo-btn {
            position: absolute;
            bottom: 12px;
            right: 12px;
            background: rgba(81, 30, 88, 0.9);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 14px;
            font-size: 0.85rem;
            text-decoration: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(4px);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 7px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .view-photo-btn i {
            font-size: 1rem;
        }
        
        .view-photo-btn:hover {
            background-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }
        
        .issue-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: #fafafa;
            border-top: 1px solid #f0f0f0;
            border-radius: 0 0 16px 16px;
        }
        
        .issue-meta {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .issue-priority {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            padding: 5px 12px;
            border-radius: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .issue-priority.low {
            background-color: rgba(40, 167, 69, 0.1);
            color: #1e7e34;
        }
        
        .issue-priority.medium {
            background-color: rgba(255, 193, 7, 0.1);
            color: #d39e00;
        }
        
        .issue-priority.critical {
            background-color: rgba(220, 53, 69, 0.1);
            color: #bd2130;
        }
        
        .issue-priority::before {
            content: '';
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: currentColor;
        }
        
        .issue-status {
            display: inline-flex;
            align-items: center;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .issue-status::before {
            content: '';
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 6px;
        }
        
        .issue-status.new {
            background-color: rgba(0, 123, 255, 0.1);
            color: #0056b3;
        }
        
        .issue-status.new::before {
            background-color: #0056b3;
        }
        
        .issue-status.in-progress,
        .issue-status.in {
            background-color: rgba(255, 193, 7, 0.1);
            color: #d39e00;
        }
        
        .issue-status.in-progress::before,
        .issue-status.in::before {
            background-color: #d39e00;
        }
        
        .issue-status.completed {
            background-color: rgba(40, 167, 69, 0.1);
            color: #1e7e34;
        }
        
        .issue-status.completed::before {
            background-color: #1e7e34;
        }
        
        .issue-actions {
            display: flex;
            gap: 10px;
        }
        
        .status-btn,
        .action-btn {
            background-color: white;
            color: var(--dark);
            border: 1px solid #e0e0e0;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }
        
        .status-btn::after,
        .action-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            opacity: 0;
            z-index: -1;
            transition: all 0.3s ease;
        }
        
        .status-btn i,
        .action-btn i {
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        /* Status-specific button styles */
        .status-btn[data-status="In Progress"] {
            color: #d39e00;
        }
        
        .status-btn[data-status="In Progress"] i {
            color: #d39e00;
        }
        
        .status-btn[data-status="Completed"] {
            color: #1e7e34;
        }
        
        .status-btn[data-status="Completed"] i {
            color: #1e7e34;
        }
        
        .status-btn[data-status="New"] {
            color: #0056b3;
        }
        
        .status-btn[data-status="New"] i {
            color: #0056b3;
        }
        
        .status-btn:hover,
        .action-btn:hover {
            color: white;
            border-color: transparent;
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(81, 30, 88, 0.2);
        }
        
        .status-btn:hover::after,
        .action-btn:hover::after {
            opacity: 1;
        }
        
        .status-btn:hover i,
        .action-btn:hover i {
            color: white;
        }
        
        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 50px 30px;
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(222, 226, 230, 0.3);
        }
        
        .empty-state::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(to right, #e0e0e0, #f0f0f0);
        }
        
        .empty-state h3 {
            margin-bottom: 15px;
            color: var(--dark);
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .empty-state p {
            color: #6c757d;
            margin-bottom: 25px;
            font-size: 1rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .empty-state .action-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 15px rgba(81, 30, 88, 0.2);
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .empty-state .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(81, 30, 88, 0.3);
        }
        
        .empty-state .action-btn i {
            font-size: 1rem;
        }
        
        /* Error state */
        .error-state {
            text-align: center;
            padding: 50px 30px;
            background-color: #fff5f5;
            border-radius: 16px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.04);
            border: 1px solid rgba(220, 53, 69, 0.1);
        }
        
        .error-state::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(to right, #dc3545, #f27c87);
        }
        
        .error-state h3 {
            margin-bottom: 15px;
            color: #842029;
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .error-state p {
            color: #842029;
            margin-bottom: 25px;
            font-size: 1rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .error-state .action-btn {
            background: linear-gradient(135deg, #842029 0%, #e74c3c 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 15px rgba(132, 32, 41, 0.2);
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .error-state .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(132, 32, 41, 0.3);
        }
        
        .error-state .action-btn i {
            font-size: 1rem;
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 50px;
            margin-bottom: 40px;
        }
        
        .pagination-btn {
            min-width: 45px;
            height: 45px;
            border: 1px solid rgba(222, 226, 230, 0.5);
            background-color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--dark);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.03);
        }
        
        .pagination-btn:hover:not(.disabled) {
            border-color: var(--primary);
            background-color: #f8f5f9;
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(81, 30, 88, 0.1);
        }
        
        .pagination-btn.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 8px 15px rgba(81, 30, 88, 0.2);
        }
        
        .pagination-btn.disabled {
            color: #b0b0b0;
            cursor: not-allowed;
            opacity: 0.6;
            pointer-events: none;
        }
        
        .pagination-ellipsis {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 45px;
            height: 45px;
            font-weight: bold;
            color: var(--dark);
        }
        
        /* Branch actions */
        .button-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        /* Styles for Export to Excel Button (from buttons example/Export to Excel css.css) */
        .container-btn-file {
            display: flex;
            position: relative;
            justify-content: center;
            align-items: center;
            background-color: #307750;
            color: #fff;
            border-style: none;
            padding: 0.8em 1.5em;
            border-radius: 0.5em;
            overflow: hidden;
            z-index: 1;
            box-shadow: 4px 8px 10px -3px rgba(0, 0, 0, 0.2);
            transition: all 250ms;
            cursor: pointer;
            gap: 10px;
            height: 45px;
            width: 340px;
            font-size: 16px;
            font-weight: 500;
        }
        .container-btn-file > svg {
        }
        .container-btn-file::before {
            content: "";
            position: absolute;
            height: 100%;
            width: 0;
            border-radius: 0.5em;
            background-color: #469b61;
            z-index: -1;
            transition: all 350ms;
            left: 0;
        }
        .container-btn-file:hover::before {
            width: 100%;
        }
         .container-btn-file:hover {
             box-shadow: 0 6px 15px rgba(48, 119, 80, 0.3);
         }

        /* Styles for Print View Button (from buttons example/prin view css.css) */
        .print-btn {
            width: 340px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
            border: 1px solid rgb(213, 213, 213);
            border-radius: 10px;
            gap: 10px;
            font-size: 16px;
            cursor: pointer;
            overflow: hidden;
            font-weight: 500;
            box-shadow: 0px 6px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        .printer-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 100%;
        }
        .printer-container {
            height: 50%;
            width: 100%;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }
        .printer-container svg {
            width: 100%;
            height: auto;
            transform: translateY(4px);
        }
        .printer-page-wrapper {
            width: 100%;
            height: 50%;
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }
        .printer-page {
            width: 70%;
            height: 10px;
            border: 1px solid black;
            background-color: white;
            transform: translateY(0px);
            transition: all 0.3s;
            transform-origin: top;
        }
        .print-btn:hover .printer-page {
            height: 16px;
            background-color: rgb(239, 239, 239);
        }
        .print-btn:hover {
            background-color: rgb(239, 239, 239);
            box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        /* Styles for Delete Tasks Button (from buttons example/delete button.css) */
        .delete-btn {
            width: 340px;
            height: 45px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #e62222;
            border: none;
            border-radius: 10px;
            box-shadow: 0px 6px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            transition: background-color 500ms;
        }

        .delete-btn .text {
            color: white;
            font-weight: bold;
            transition: transform 500ms, color 300ms, opacity 300ms;
            font-size: 16px;
            text-align: center;
        }

        .delete-btn .icon {
            position: absolute;
            right: 0;
            top: 0;
            transform: translateX(50px);
            opacity: 0;
            height: 100%;
            width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 500ms, opacity 400ms;
            background-color: #c41b1b;
        }

        .delete-btn svg {
            width: 18px;
            height: 18px;
            fill: #eee;
        }

        .delete-btn:hover {
            background: #ff3636;
            box-shadow: 0px 8px 15px rgba(230, 34, 34, 0.2);
        }

        .delete-btn:hover .text {
            opacity: 0;
            color: rgba(255, 255, 255, 0);
        }

        .delete-btn:hover .icon {
            width: 100%;
            transform: translateX(0);
            opacity: 1;
            border-left: none;
        }

        .delete-btn:focus {
            outline: none;
        }

        .delete-btn:active .icon svg {
            transform: scale(0.8);
        }
        .actions-card .button-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
            justify-content: center;
        }

        /* Branch selector styling */
        .branch-selector-container {
            margin-bottom: 30px; /* Add space below the dropdown */
            position: relative; /* Needed for z-index */
            z-index: 2; /* Ensure it stays above dashboard cards on hover */
        }
        
        .branch-selector {
            width: 100%;
            max-width: 400px; /* Limit max width */
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
        }

        /* Filter Toggle Button */
        .toggle-filters-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 15px; /* Space between button and list */
            box-shadow: 0 4px 8px rgba(81, 30, 88, 0.15);
        }
        
        .toggle-filters-btn:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(81, 30, 88, 0.2);
        }
        
        .toggle-filters-btn i {
            transition: transform 0.3s ease;
        }
        
        .toggle-filters-btn.expanded i {
            transform: rotate(180deg);
        }
        
        /* Refresh List Button */
        #refreshListBtn {
            background-color: #f8f9fa;
            color: #3498db;
            border: 1px solid #e6e6e6;
            margin-left: 10px;
            padding: 10px 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        #refreshListBtn:hover {
            background-color: #e9f7fe;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.15);
        }
        
        #refreshListBtn i {
            margin-right: 5px;
        }
        
        /* Filter wrapper for button layout */
        .filter-wrapper {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 15px;
            position: relative; /* Make this a positioning context */
        }
        
        /* Filter buttons container */
        .filter-buttons {
            display: flex;
            gap: 10px;
            z-index: 10; /* Ensure buttons stay above the filter section */
            position: relative; /* Keep the buttons in the normal flow */
            background-color: transparent; /* Ensure background is transparent */
        }
        
        /* Filter section positioning */
        .filter-section {
            position: absolute; /* Position it absolutely */
            top: 100%; /* Place it below the buttons */
            left: 0;
            right: 0;
            width: 100%;
            z-index: 5; /* Below buttons but above other content */
            margin-top: 5px; /* Small gap below buttons */
            max-height: 0;
            padding: 0;
            overflow: hidden;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #ffffff 0%, #f8f8ff 100%);
            border: 1px solid rgba(81, 30, 88, 0.08);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            visibility: hidden;
            opacity: 0;
        }

        /* Collapsible Filter Section */
        .filter-section.expanded {
            max-height: 1000px; /* Large enough height when expanded */
            padding: 25px;
            margin-bottom: 20px;
            visibility: visible;
            opacity: 1;
        }
        
        /* Hide filter grid content when collapsed */
        .filter-section:not(.expanded) .filter-grid {
            display: none;
        }
        
        /* Add space below filter wrapper when expanded */
        .filter-wrapper {
            margin-bottom: 15px;
            transition: margin-bottom 0.3s ease;
        }
        
        /* Remove :has() selector for better browser compatibility */
        /* .filter-wrapper:has(.filter-section.expanded) {
            --filter-height: 410px;
            margin-bottom: var(--filter-height);
        } */

        /* Issues list spacing */
        .issues-list {
            margin-top: 30px; /* Add some space between filters and issues list */
        }

        /* Hide pagination by default */
        #paginationContainer {
            display: none; 
        }

        /* Custom Choices.js Styling */
        .choices {
            margin-bottom: 0; /* Remove default margin */
        }
        .choices__inner {
            background-color: rgb(255, 255, 255);
            border-radius: 8px;
            border: 1px solid var(--border);
            padding: 7px 12px; /* Adjust padding */
            font-size: 1rem;
            min-height: auto; /* Override default min-height */
            transition: border-color 0.2s ease;
        }
        .is-focused .choices__inner, .is-open .choices__inner {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(81, 30, 88, 0.1);
        }
        .choices__list--dropdown {
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.2); /* Slightly darker border for definition */
            margin-top: 5px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            z-index: 50; /* Increase z-index significantly */
            background-color: white;
            color: var(--text-color);
            max-height: 280px; /* Limit height to show 7 items */
            overflow-y: auto;
        }
        .choices__list--dropdown .choices__item--selectable.is-highlighted {
            background-color: rgba(58, 123, 213, 0.1);
            color: var(--primary-color);
        }
        /* Override default hover background */
        .choices__list--dropdown .choices__item--selectable:hover {
            background-color: rgba(58, 123, 213, 0.1); /* Subtle hover effect, consistent with theme */
        }
        /* Placeholder styling */
        .choices__placeholder {
            color: #6c757d;
            opacity: 1;
        }
        /* Adjust input padding */
        .choices__input {
            padding: 0;
            background-color: transparent;
        }
        
        /* Minimalistic scrollbar styles for dropdowns */
        .choices__list--dropdown::-webkit-scrollbar {
            width: 6px;
        }
        
        .choices__list--dropdown::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 3px;
        }
        
        .choices__list--dropdown::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }
        
        .choices__list--dropdown::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }
        
        /* Firefox scrollbar */
        .choices__list--dropdown {
            scrollbar-width: thin;
            scrollbar-color: rgba(0, 0, 0, 0.2) rgba(0, 0, 0, 0.05);
        }

        /* Visually hidden class for accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* Page Header Row Styling */
        .page-header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
            font-size: 1rem;
        }

        .page-title h1 {
            margin-top: 0;
            margin-bottom: 0;
        }

        /* Branch Info/Selector Box Styling */
        .branch-info-selector {
            background-color: #ffffff;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
            min-width: 300px;
            max-width: 450px;
            flex-shrink: 0;
            position: relative; /* Establish stacking context */
            z-index: 5; /* Higher z-index than dashboard */
        }

        .branch-info-selector p#branchName {
            font-weight: 600;
            color: var(--primary);
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 0.95rem;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 8px;
        }

        /* Override Choices.js width inside this container */
        .branch-info-selector .choices {
             width: 100%;
        }

        /* Remove margin from the inner container */
        .branch-selector-container {
            margin-bottom: 0; 
            z-index: initial;
            position: static;
        }

        /* --- NEW MODERN ISSUE CARD STYLES --- */

        .modern-card {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e9ecef;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.3s ease;
            border-left: 6px solid transparent; /* Default border */
            position: relative;
        }

        .modern-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }

        /* Priority indicators using left border */
        .modern-card.priority-low {
            border-left-color: var(--success);
        }
        .modern-card.priority-medium {
            border-left-color: var(--warning);
        }
        .modern-card.priority-critical {
            border-left-color: var(--danger);
            box-shadow: 0 8px 20px rgba(220, 53, 69, 0.1); /* Subtle shadow for critical */
        }
        
        /* Optional: Add a subtle pulse for critical tasks */
        @keyframes criticalPulse {
            0% { box-shadow: 0 8px 20px rgba(220, 53, 69, 0.1); }
            50% { box-shadow: 0 8px 25px rgba(220, 53, 69, 0.15); }
            100% { box-shadow: 0 8px 20px rgba(220, 53, 69, 0.1); }
        }
        .modern-card.priority-critical:hover {
             animation: criticalPulse 1.5s infinite ease-in-out;
        }

        .card-main-content {
            padding: 18px 20px;
            flex-grow: 1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 10px;
        }

        .card-location {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .card-location i {
            color: var(--primary);
            font-size: 1rem;
        }

        .card-date {
            font-size: 0.8rem;
            color: #6c757d;
            background-color: #f8f9fa;
            padding: 4px 10px;
            border-radius: 20px;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 5px;
            border: 1px solid #eee;
        }
        .card-date i {
            color: var(--secondary);
            font-size: 0.75rem;
        }

        .card-body {
            margin-bottom: 15px;
        }

        .card-category-priority {
            display: flex;
            gap: 15px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .card-category, .card-priority {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .card-category i, .card-priority i {
            font-size: 0.75rem;
        }

        .card-category {
            background-color: #e7f3ff;
            color: #0056b3;
        }
        /* Add more specific category colors if needed */
        .card-category.electrical { background-color: #f0f7ff; color: #0062cc; }
        .card-category.plumbing { background-color: #e6f7ff; color: #0095ff; }
        .card-category.furniture { background-color: #fff8e6; color: #d68c00; }
        .card-category.other { background-color: #f0f0f0; color: #5a5a5a; }

        .card-priority.low { background-color: rgba(40, 167, 69, 0.1); color: #1e7e34; }
        .card-priority.medium { background-color: rgba(255, 193, 7, 0.1); color: #d39e00; }
        .card-priority.critical { background-color: rgba(220, 53, 69, 0.1); color: #bd2130; }

        .card-description {
            font-size: 0.95rem;
            color: #495057;
            line-height: 1.5;
            margin-bottom: 15px;
            max-height: 100px; /* Limit height */
            overflow-y: auto;
            padding: 10px;
            background-color: #fdfdff;
            border-radius: 6px;
            border: 1px solid #f0f0f0;
            scrollbar-width: thin;
            scrollbar-color: rgba(81, 30, 88, 0.3) #f1f1f1;
        }
        .card-description::-webkit-scrollbar {
            width: 5px;
        }
        .card-description::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .card-description::-webkit-scrollbar-thumb {
            background: rgba(81, 30, 88, 0.3);
            border-radius: 10px;
        }
        .card-description::-webkit-scrollbar-thumb:hover {
            background: rgba(81, 30, 88, 0.5);
        }
        .card-description p {
             margin: 0 0 8px 0;
             word-wrap: break-word;
             overflow-wrap: break-word;
             white-space: normal;
        }
        .card-description p:last-child {
            margin-bottom: 0;
        }

        .card-photo-container {
            position: relative;
            margin-top: 15px;
            border-radius: 8px;
            overflow: hidden;
            max-height: 150px; /* Limit photo preview height */
        }
        .card-photo-container img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            transition: transform 0.3s ease;
        }
        .card-photo-container:hover img {
            transform: scale(1.05);
        }
        .card-view-photo {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .card-view-photo:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.05);
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background-color: #f8f9fa;
            border-top: 1px solid #e9ecef;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            gap: 10px;
        }

        .card-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .card-status i {
            font-size: 0.8rem;
        }

        .card-status.new { background-color: rgba(0, 123, 255, 0.1); color: #0056b3; }
        .card-status.new i { color: #0056b3; }
        .card-status.in-progress, .card-status.in { background-color: rgba(255, 193, 7, 0.1); color: #d39e00; }
        .card-status.in-progress i, .card-status.in i { color: #d39e00; }
        .card-status.completed { background-color: rgba(40, 167, 69, 0.1); color: #1e7e34; }
        .card-status.completed i { color: #1e7e34; }

        .card-actions {
            display: flex;
            gap: 8px;
        }

        /* Use existing .status-btn styles, maybe slight adjustments needed */
        .card-actions .status-btn {
            padding: 6px 12px; /* Slightly smaller buttons */
            font-size: 0.8rem;
            border-radius: 15px;
        }
        .card-actions .status-btn i {
            font-size: 0.85rem;
        }
        
        /* Small spinner for buttons */
        .spinner-small {
            display: inline-block;
            width: 1em;
            height: 1em;
            border: 2px solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            vertical-align: middle;
            margin: 0 2px;
        }

        /* New wrapper for description and photo */
        .card-description-photo-wrapper {
            display: flex;
            gap: 15px;
            align-items: flex-start; /* Align items to the top */
            margin-bottom: 15px;
        }

        .card-description {
            flex: 1 1 auto; /* Allow description to grow and shrink, but prefer its content size */
            font-size: 0.95rem;
            color: #495057;
            line-height: 1.5;
            margin-bottom: 0; /* Remove bottom margin as it's handled by wrapper */
            max-height: 150px; /* Keep max-height for scrollability */
            min-height: 80px; /* Give it a minimum height */
            overflow-y: auto;
            padding: 10px;
            background-color: #fdfdff;
            border-radius: 6px;
            border: 1px solid #f0f0f0;
            scrollbar-width: thin;
            scrollbar-color: rgba(81, 30, 88, 0.3) #f1f1f1;
        }
        /* ... existing scrollbar styles for card-description ... */
        .card-description::-webkit-scrollbar {
            width: 5px;
        }
        .card-description::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .card-description::-webkit-scrollbar-thumb {
            background: rgba(81, 30, 88, 0.3);
            border-radius: 10px;
        }
        .card-description::-webkit-scrollbar-thumb:hover {
            background: rgba(81, 30, 88, 0.5);
        }
        .card-description p {
             margin: 0 0 8px 0;
             word-wrap: break-word;
             overflow-wrap: break-word;
             white-space: normal;
        }
        .card-description p:last-child {
            margin-bottom: 0;
        }

        .card-photo-container {
            flex: 0 0 120px; /* Give photo a fixed width, prevent shrinking/growing */
            position: relative;
            margin-top: 0; /* Remove top margin */
            border-radius: 8px;
            overflow: hidden;
            height: 120px; /* Give photo a fixed height */
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08); /* Add subtle shadow */
        }
        /* Ensure photo exists before applying wrapper styles */
        /* Using a more compatible approach: add class 'has-photo' via JS if needed */
        /* For now, assume description takes available space */

        .card-photo-container img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            transition: transform 0.3s ease;
        }
        .card-photo-container:hover img {
            transform: scale(1.05);
        }
        .card-view-photo {
            position: absolute;
            bottom: 8px; /* Adjust position */
            right: 8px;  /* Adjust position */
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 10px; /* Adjust padding */
            border-radius: 20px;
            font-size: 0.75rem; /* Adjust font size */
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px; /* Adjust gap */
            opacity: 0; /* Hide by default */
            transform: translateY(5px); /* Start slightly down */
        }
        .card-photo-container:hover .card-view-photo {
             opacity: 1; /* Show on hover */
             transform: translateY(0); /* Move up on hover */
        }
        .card-view-photo:hover {
            background: rgba(0, 0, 0, 0.9);
        }

        .card-footer {
            /* pointer-events: none; REMOVED */
        }

        /* Separator Footer for Maintenance Cards */
        .maintenance-footer {
            border-top: 1px solid #e9ecef; /* Separator line */
            padding: 15px 20px; /* Padding top/bottom and left/right */
            margin-top: auto; /* Changed from 15px to auto to push footer down */
            background-color: #f8f9fa; /* Subtle background for footer area */
            border-bottom-left-radius: 12px; /* Match card radius */
            border-bottom-right-radius: 12px; /* Match card radius */
            display: flex; /* Use flex for alignment */
            /* justify-content: center; Removed */
        }

        /* --- REMOVING OLD BUTTON STYLES --- */
        /* Styles for Export to Excel Button (from buttons example/Export to Excel css.css) */
        /* .container-btn-file { ... removed ... } */
        /* Styles for Print View Button (from buttons example/prin view css.css) */
        /* .print-btn { ... removed ... } */
        /* Styles for Delete Tasks Button (from buttons example/delete button.css) */
        /* .delete-btn { ... removed ... } */

        /* --- ADDING NEW BUTTON STYLES --- */

        /* New Excel Button Styles (Branch Actions) */
        .excel-button-tracking {
          display: flex;
          position: relative;
          justify-content: center;
          align-items: center;
          background-color: #307750;
          color: #fff;
          border-style: none;
          padding: 1em 1.5em; /* Adjusted padding */
          border-radius: 0.5em;
          overflow: hidden;
          z-index: 1;
          box-shadow: 4px 8px 10px -3px rgba(0, 0, 0, 0.2);
          transition: all 250ms;
          cursor: pointer;
          gap: 10px;
          font-size: 15px; /* Adjusted font size */
          font-weight: 500;
          flex-grow: 1;
          min-height: 45px;
          text-align: center;
        }
        .excel-button-tracking > svg {
           flex-shrink: 0; /* Prevent SVG from shrinking */
        }
        .excel-button-tracking::before {
          content: "";
          position: absolute;
          height: 100%;
          width: 0;
          border-radius: 0.5em;
          background-color: #469b61;
          z-index: -1;
          transition: all 350ms;
          left: 0;
        }
        .excel-button-tracking:hover::before {
          width: 100%;
        }
         .excel-button-tracking:hover {
             box-shadow: 0 6px 15px rgba(48, 119, 80, 0.3);
         }

        /* New Print Button Styles (Branch Actions) */
        .print-button-tracking {
          height: 45px;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: white;
          border: 1px solid rgb(213, 213, 213);
          border-radius: 10px;
          gap: 10px;
          font-size: 15px;
          cursor: pointer;
          overflow: hidden;
          font-weight: 500;
          box-shadow: 0px 6px 10px rgba(0, 0, 0, 0.05);
          transition: all 0.3s;
          flex-grow: 1;
          padding: 0 1.5em;
          text-align: center;
        }
        .print-button-tracking .printer-wrapper {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          width: 20px;
          height: 100%;
          flex-shrink: 0;
        }
        .print-button-tracking .printer-container {
          height: 50%;
          width: 100%;
          display: flex;
          align-items: flex-end;
          justify-content: center;
        }
        .print-button-tracking .printer-container svg {
          width: 100%;
          height: auto;
          transform: translateY(4px);
        }
        .print-button-tracking .printer-page-wrapper {
          width: 100%;
          height: 50%;
          display: flex;
          align-items: flex-start;
          justify-content: center;
        }
        .print-button-tracking .printer-page {
          width: 70%;
          height: 10px;
          border: 1px solid black;
          background-color: white;
          transform: translateY(0px);
          transition: all 0.3s;
          transform-origin: top;
        }
        .print-button-tracking:hover .printer-page {
          height: 16px;
          background-color: rgb(239, 239, 239);
        }
        .print-button-tracking:hover {
          background-color: rgb(239, 239, 239);
          box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.1);
          transform: translateY(-2px);
        }

        /* New Delete Button Styles (Branch Actions) */
        .delete-button-tracking {
          height: 45px;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          background: #e62222;
          border: none;
          border-radius: 10px;
          box-shadow: 0px 6px 10px rgba(0, 0, 0, 0.1);
          position: relative;
          overflow: hidden;
          transition: background-color 500ms;
          flex-grow: 1;
          padding: 0 1.5em;
        }
        .delete-button-tracking .text {
          color: white;
          font-weight: bold;
          transition: transform 500ms, color 300ms, opacity 300ms;
          font-size: 15px;
          text-align: center;
          transform: translateX(0);
        }
        .delete-button-tracking .icon {
          position: absolute;
          right: 0;
          top: 0;
          transform: translateX(50px);
          opacity: 0;
          height: 100%;
          width: 50px;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: transform 500ms, opacity 400ms;
          background-color: #c41b1b;
        }
        .delete-button-tracking svg {
          width: 18px;
          height: 18px;
          fill: #eee;
        }
        .delete-button-tracking:hover {
          background: #ff3636;
          box-shadow: 0px 8px 15px rgba(230, 34, 34, 0.2);
        }
        .delete-button-tracking:hover .text {
          opacity: 0;
          transform: translateX(-150%);
        }
        .delete-button-tracking:hover .icon {
          width: 100%;
          transform: translateX(0);
          opacity: 1;
        }
        .delete-button-tracking:focus {
          outline: none;
        }
        .delete-button-tracking:active .icon svg {
          transform: scale(0.8);
        }

         /* New Print Button Style for Maintenance Cards */
        .print-style-btn {
          height: 40px; /* Set a suitable height */
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: white;
          border: 1px solid rgb(213, 213, 213);
          border-radius: 10px;
          gap: 10px;
          font-size: 14px; /* Slightly smaller font */
          cursor: pointer;
          overflow: hidden;
          font-weight: 500;
          /* box-shadow: 0px 6px 10px rgba(0, 0, 0, 0.05); Removed */
          transition: all 0.3s;
          color: #334155; 
          padding: 0 1em;
          width: 100%; /* Changed from auto to 100% */
          /* min-width: 150px; Removed */
        }
        .print-style-btn .printer-wrapper {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          width: 20px;
          height: 100%;
          flex-shrink: 0;
        }
        .print-style-btn .printer-container {
          height: 50%;
          width: 100%;
          display: flex;
          align-items: flex-end;
          justify-content: center;
        }
        .print-style-btn .printer-container svg {
          width: 100%;
          height: auto;
          transform: translateY(4px);
        }
        .print-style-btn .printer-page-wrapper {
          width: 100%;
          height: 50%;
          display: flex;
          align-items: flex-start;
          justify-content: center;
        }
        .print-style-btn .printer-page {
          width: 70%;
          height: 10px;
          border: 1px solid black;
          background-color: white;
          transform: translateY(0px);
          transition: all 0.3s;
          transform-origin: top;
        }
        .print-style-btn:hover .printer-page {
          height: 16px;
          background-color: rgb(239, 239, 239);
        }
        .print-style-btn:hover {
          background-color: rgb(239, 239, 239);
          /* box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.1); Removed */
          /* transform: translateY(-2px); Removed */
        }
        .print-style-btn:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             pointer-events: none;
             filter: grayscale(50%);
        }

        /* Disabled state for Branch Action buttons */
         .excel-button-tracking:disabled,
         .print-button-tracking:disabled,
         .delete-button-tracking:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             pointer-events: none;
             filter: grayscale(50%);
         }
         .delete-button-tracking:disabled:hover .icon {
             width: 50px; 
             opacity: 0;
             transform: translateX(50px); 
         }
          .delete-button-tracking:disabled:hover .text {
             transform: translateX(0);
             opacity: 1;
         }

        /* --- END NEW BUTTON STYLES --- */

        .actions-card .button-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
            justify-content: center;
        }

        /* Branch selector styling */
        .branch-selector-container {
            margin-bottom: 30px; /* Add space below the dropdown */
            position: relative; /* Needed for z-index */
            z-index: 2; /* Ensure it stays above dashboard cards on hover */
        }
        
        .branch-selector {
            width: 100%;
            max-width: 400px; /* Limit max width */
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
        }

        /* Filter Toggle Button */
        .toggle-filters-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 15px; /* Space between button and list */
            box-shadow: 0 4px 8px rgba(81, 30, 88, 0.15);
        }
        
        .toggle-filters-btn:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(81, 30, 88, 0.2);
        }
        
        .toggle-filters-btn i {
            transition: transform 0.3s ease;
        }
        
        .toggle-filters-btn.expanded i {
            transform: rotate(180deg);
        }
        
        /* Refresh List Button */
        #refreshListBtn {
            background-color: #f8f9fa;
            color: #3498db;
            border: 1px solid #e6e6e6;
            margin-left: 10px;
            padding: 10px 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        #refreshListBtn:hover {
            background-color: #e9f7fe;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.15);
        }
        
        #refreshListBtn i {
            margin-right: 5px;
        }
        
        /* Filter wrapper for button layout */
        .filter-wrapper {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 15px;
            position: relative; /* Make this a positioning context */
        }
        
        /* Filter buttons container */
        .filter-buttons {
            display: flex;
            gap: 10px;
            z-index: 10; /* Ensure buttons stay above the filter section */
            position: relative; /* Keep the buttons in the normal flow */
            background-color: transparent; /* Ensure background is transparent */
        }
        
        /* Filter section positioning */
        .filter-section {
            position: absolute; /* Position it absolutely */
            top: 100%; /* Place it below the buttons */
            left: 0;
            right: 0;
            width: 100%;
            z-index: 5; /* Below buttons but above other content */
            margin-top: 5px; /* Small gap below buttons */
            max-height: 0;
            padding: 0;
            overflow: hidden;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #ffffff 0%, #f8f8ff 100%);
            border: 1px solid rgba(81, 30, 88, 0.08);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            visibility: hidden;
            opacity: 0;
        }

        /* Collapsible Filter Section */
        .filter-section.expanded {
            max-height: 1000px; /* Large enough height when expanded */
            padding: 25px;
            margin-bottom: 20px;
            visibility: visible;
            opacity: 1;
        }
        
        /* Hide filter grid content when collapsed */
        .filter-section:not(.expanded) .filter-grid {
            display: none;
        }
        
        /* Add space below filter wrapper when expanded */
        .filter-wrapper {
            margin-bottom: 15px;
            transition: margin-bottom 0.3s ease;
        }
        
        /* Remove :has() selector for better browser compatibility */
        /* .filter-wrapper:has(.filter-section.expanded) {
            --filter-height: 410px;
            margin-bottom: var(--filter-height);
        } */

        /* Issues list spacing */
        .issues-list {
            margin-top: 30px; /* Add some space between filters and issues list */
        }

        /* Hide pagination by default */
        #paginationContainer {
            display: none; 
        }

        /* Custom Choices.js Styling */
        .choices {
            margin-bottom: 0; /* Remove default margin */
        }
        .choices__inner {
            background-color: rgb(255, 255, 255);
            border-radius: 8px;
            border: 1px solid var(--border);
            padding: 7px 12px; /* Adjust padding */
            font-size: 1rem;
            min-height: auto; /* Override default min-height */
            transition: border-color 0.2s ease;
        }
        .is-focused .choices__inner, .is-open .choices__inner {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(81, 30, 88, 0.1);
        }
        .choices__list--dropdown {
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.2); /* Slightly darker border for definition */
            margin-top: 5px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            z-index: 50; /* Increase z-index significantly */
            background-color: white;
            color: var(--text-color);
            max-height: 280px; /* Limit height to show 7 items */
            overflow-y: auto;
        }
        .choices__list--dropdown .choices__item--selectable.is-highlighted {
            background-color: rgba(58, 123, 213, 0.1);
            color: var(--primary-color);
        }
        /* Override default hover background */
        .choices__list--dropdown .choices__item--selectable:hover {
            background-color: rgba(58, 123, 213, 0.1); /* Subtle hover effect, consistent with theme */
        }
        /* Placeholder styling */
        .choices__placeholder {
            color: #6c757d;
            opacity: 1;
        }
        /* Adjust input padding */
        .choices__input {
            padding: 0;
            background-color: transparent;
        }
        
        /* Minimalistic scrollbar styles for dropdowns */
        .choices__list--dropdown::-webkit-scrollbar {
            width: 6px;
        }
        
        .choices__list--dropdown::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 3px;
        }
        
        .choices__list--dropdown::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }
        
        .choices__list--dropdown::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }
        
        /* Firefox scrollbar */
        .choices__list--dropdown {
            scrollbar-width: thin;
            scrollbar-color: rgba(0, 0, 0, 0.2) rgba(0, 0, 0, 0.05);
        }

        /* Visually hidden class for accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* Page Header Row Styling */
        .page-header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
            font-size: 1rem;
        }

        .page-title h1 {
            margin-top: 0;
            margin-bottom: 0;
        }

        /* Branch Info/Selector Box Styling */
        .branch-info-selector {
            background-color: #ffffff;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
            min-width: 300px;
            max-width: 450px;
            flex-shrink: 0;
            position: relative; /* Establish stacking context */
            z-index: 5; /* Higher z-index than dashboard */
        }

        .branch-info-selector p#branchName {
            font-weight: 600;
            color: var(--primary);
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 0.95rem;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 8px;
        }

        /* Override Choices.js width inside this container */
        .branch-info-selector .choices {
             width: 100%;
        }

        /* Remove margin from the inner container */
        .branch-selector-container {
            margin-bottom: 0; 
            z-index: initial;
            position: static;
        }

        /* --- NEW MODERN ISSUE CARD STYLES --- */

        .modern-card {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e9ecef;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.3s ease;
            border-left: 6px solid transparent; /* Default border */
            position: relative;
        }

        .modern-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }

        /* Priority indicators using left border */
        .modern-card.priority-low {
            border-left-color: var(--success);
        }
        .modern-card.priority-medium {
            border-left-color: var(--warning);
        }
        .modern-card.priority-critical {
            border-left-color: var(--danger);
            box-shadow: 0 8px 20px rgba(220, 53, 69, 0.1); /* Subtle shadow for critical */
        }
        
        /* Optional: Add a subtle pulse for critical tasks */
        @keyframes criticalPulse {
            0% { box-shadow: 0 8px 20px rgba(220, 53, 69, 0.1); }
            50% { box-shadow: 0 8px 25px rgba(220, 53, 69, 0.15); }
            100% { box-shadow: 0 8px 20px rgba(220, 53, 69, 0.1); }
        }
        .modern-card.priority-critical:hover {
             animation: criticalPulse 1.5s infinite ease-in-out;
        }

        .card-main-content {
            padding: 18px 20px;
            flex-grow: 1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 10px;
        }

        .card-location {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .card-location i {
            color: var(--primary);
            font-size: 1rem;
        }

        .card-date {
            font-size: 0.8rem;
            color: #6c757d;
            background-color: #f8f9fa;
            padding: 4px 10px;
            border-radius: 20px;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 5px;
            border: 1px solid #eee;
        }
        .card-date i {
            color: var(--secondary);
            font-size: 0.75rem;
        }

        .card-body {
            margin-bottom: 15px;
        }

        .card-category-priority {
            display: flex;
            gap: 15px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .card-category, .card-priority {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .card-category i, .card-priority i {
            font-size: 0.75rem;
        }

        .card-category {
            background-color: #e7f3ff;
            color: #0056b3;
        }
        /* Add more specific category colors if needed */
        .card-category.electrical { background-color: #f0f7ff; color: #0062cc; }
        .card-category.plumbing { background-color: #e6f7ff; color: #0095ff; }
        .card-category.furniture { background-color: #fff8e6; color: #d68c00; }
        .card-category.other { background-color: #f0f0f0; color: #5a5a5a; }

        .card-priority.low { background-color: rgba(40, 167, 69, 0.1); color: #1e7e34; }
        .card-priority.medium { background-color: rgba(255, 193, 7, 0.1); color: #d39e00; }
        .card-priority.critical { background-color: rgba(220, 53, 69, 0.1); color: #bd2130; }

        .card-description {
            font-size: 0.95rem;
            color: #495057;
            line-height: 1.5;
            margin-bottom: 15px;
            max-height: 100px; /* Limit height */
            overflow-y: auto;
            padding: 10px;
            background-color: #fdfdff;
            border-radius: 6px;
            border: 1px solid #f0f0f0;
            scrollbar-width: thin;
            scrollbar-color: rgba(81, 30, 88, 0.3) #f1f1f1;
        }
        .card-description::-webkit-scrollbar {
            width: 5px;
        }
        .card-description::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .card-description::-webkit-scrollbar-thumb {
            background: rgba(81, 30, 88, 0.3);
            border-radius: 10px;
        }
        .card-description::-webkit-scrollbar-thumb:hover {
            background: rgba(81, 30, 88, 0.5);
        }
        .card-description p {
             margin: 0 0 8px 0;
             word-wrap: break-word;
             overflow-wrap: break-word;
             white-space: normal;
        }
        .card-description p:last-child {
            margin-bottom: 0;
        }

        .card-photo-container {
            position: relative;
            margin-top: 15px;
            border-radius: 8px;
            overflow: hidden;
            max-height: 150px; /* Limit photo preview height */
        }
        .card-photo-container img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            transition: transform 0.3s ease;
        }
        .card-photo-container:hover img {
            transform: scale(1.05);
        }
        .card-view-photo {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .card-view-photo:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.05);
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background-color: #f8f9fa;
            border-top: 1px solid #e9ecef;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            gap: 10px;
        }

        .card-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .card-status i {
            font-size: 0.8rem;
        }

        .card-status.new { background-color: rgba(0, 123, 255, 0.1); color: #0056b3; }
        .card-status.new i { color: #0056b3; }
        .card-status.in-progress, .card-status.in { background-color: rgba(255, 193, 7, 0.1); color: #d39e00; }
        .card-status.in-progress i, .card-status.in i { color: #d39e00; }
        .card-status.completed { background-color: rgba(40, 167, 69, 0.1); color: #1e7e34; }
        .card-status.completed i { color: #1e7e34; }

        .card-actions {
            display: flex;
            gap: 8px;
        }

        /* Use existing .status-btn styles, maybe slight adjustments needed */
        .card-actions .status-btn {
            padding: 6px 12px; /* Slightly smaller buttons */
            font-size: 0.8rem;
            border-radius: 15px;
        }
        .card-actions .status-btn i {
            font-size: 0.85rem;
        }
        
        /* Small spinner for buttons */
        .spinner-small {
            display: inline-block;
            width: 1em;
            height: 1em;
            border: 2px solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            vertical-align: middle;
            margin: 0 2px;
        }

        /* New wrapper for description and photo */
        .card-description-photo-wrapper {
            display: flex;
            gap: 15px;
            align-items: flex-start; /* Align items to the top */
            margin-bottom: 15px;
        }

        .card-description {
            flex: 1 1 auto; /* Allow description to grow and shrink, but prefer its content size */
            font-size: 0.95rem;
            color: #495057;
            line-height: 1.5;
            margin-bottom: 0; /* Remove bottom margin as it's handled by wrapper */
            max-height: 150px; /* Keep max-height for scrollability */
            min-height: 80px; /* Give it a minimum height */
            overflow-y: auto;
            padding: 10px;
            background-color: #fdfdff;
            border-radius: 6px;
            border: 1px solid #f0f0f0;
            scrollbar-width: thin;
            scrollbar-color: rgba(81, 30, 88, 0.3) #f1f1f1;
        }
        /* ... existing scrollbar styles for card-description ... */
        .card-description::-webkit-scrollbar {
            width: 5px;
        }
        .card-description::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .card-description::-webkit-scrollbar-thumb {
            background: rgba(81, 30, 88, 0.3);
            border-radius: 10px;
        }
        .card-description::-webkit-scrollbar-thumb:hover {
            background: rgba(81, 30, 88, 0.5);
        }
        .card-description p {
             margin: 0 0 8px 0;
             word-wrap: break-word;
             overflow-wrap: break-word;
             white-space: normal;
        }
        .card-description p:last-child {
            margin-bottom: 0;
        }

        .card-photo-container {
            flex: 0 0 120px; /* Give photo a fixed width, prevent shrinking/growing */
            position: relative;
            margin-top: 0; /* Remove top margin */
            border-radius: 8px;
            overflow: hidden;
            height: 120px; /* Give photo a fixed height */
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08); /* Add subtle shadow */
        }
        /* Ensure photo exists before applying wrapper styles */
        /* Using a more compatible approach: add class 'has-photo' via JS if needed */
        /* For now, assume description takes available space */

        .card-photo-container img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            transition: transform 0.3s ease;
        }
        .card-photo-container:hover img {
            transform: scale(1.05);
        }
        .card-view-photo {
            position: absolute;
            bottom: 8px; /* Adjust position */
            right: 8px;  /* Adjust position */
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 10px; /* Adjust padding */
            border-radius: 20px;
            font-size: 0.75rem; /* Adjust font size */
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px; /* Adjust gap */
            opacity: 0; /* Hide by default */
            transform: translateY(5px); /* Start slightly down */
        }
        .card-photo-container:hover .card-view-photo {
             opacity: 1; /* Show on hover */
             transform: translateY(0); /* Move up on hover */
        }
        .card-view-photo:hover {
            background: rgba(0, 0, 0, 0.9);
        }

        .card-footer {
            /* pointer-events: none; REMOVED */
        }
    </style>
</head>
<body>
    <!-- Loading indicator -->
    <div class="loading-container" id="loadingContainer">
        <div class="loading-spinner"></div>
    </div>

    <!-- Notification container -->
    <div id="notificationContainer"></div>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-brand">
                <img src="images/PremierFix.png" alt="PremierFix Logo" class="brand-logo" onerror="this.style.display='none'; this.parentElement.innerHTML='PremierFix';">
            </div>
            <div class="nav-links">
                <a href="index.html">Log Issue</a>
                <a href="tracking-new.html" class="active">Track Issues</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Header Row with Title and Branch Selector -->
        <div class="page-header-row">
            <div class="page-title">
                <h1>Maintenance Tracker</h1>
            </div>
            <!-- Added inline style for margin-top -->
            <div class="branch-info-selector" style="margin-top: 1.5rem;">
                <p id="branchName">Loading branch information...</p>
                <div class="branch-selector-container">
                    <label for="branchSelector" class="sr-only">Select Branch:</label>
                    <select id="branchSelector" class="branch-selector">
                        <option value="">Loading branches...</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="maintenance-card" id="acFilterCard">
                <div style="flex-grow: 1;"> <!-- Added wrapper div -->
                    <div class="maintenance-header">
                        <div class="maintenance-icon">
                            <i class="fas fa-fan"></i>
                        </div>
                        <div>
                            <h3 class="maintenance-title">AC Filter Maintenance</h3>
                        </div>
                    </div>
                    <p>Regular maintenance of AC filters in all rooms</p>
                    <div class="maintenance-status unknown">Unknown</div>
                    <div class="maintenance-date">No record</div>
                </div> <!-- Closed wrapper div -->
                <div class="maintenance-footer">
                    <button class="maintenance-action print-style-btn" data-task-type="ac-filter">
                        <span class="printer-wrapper">
                        <span class="printer-container">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 92 75">
                            <path stroke-width="5" stroke="black" d="M12 37.5H80C85.2467 37.5 89.5 41.7533 89.5 47V69C89.5 70.933 87.933 72.5 86 72.5H6C4.067 72.5 2.5 70.933 2.5 69V47C2.5 41.7533 6.75329 37.5 12 37.5Z"></path>
                            <mask fill="white" id="print-mask-ac"><path d="M12 12C12 5.37258 17.3726 0 24 0H57C70.2548 0 81 10.7452 81 24V29H12V12Z"></path></mask>
                            <path mask="url(#print-mask-ac)" fill="black" d="M7 12C7 2.61116 14.6112 -5 24 -5H57C73.0163 -5 86 7.98374 86 24H76C76 13.5066 67.4934 5 57 5H24C20.134 5 17 8.13401 17 12H7ZM81 29H12H81ZM7 29V12C7 2.61116 14.6112 -5 24 -5V5C20.134 5 17 8.13401 17 12V29H7ZM57 -5C73.0163 -5 86 7.98374 86 24V29H76V24C76 13.5066 67.4934 5 57 5V-5Z"></path>
                            <circle fill="black" r="3" cy="49" cx="78"></circle>
                          </svg>
                        </span>
                        <span class="printer-page-wrapper">
                          <span class="printer-page"></span>
                        </span>
                      </span>
                      Mark Complete
                    </button>
                </div>
            </div>
            
            <div class="maintenance-card" id="bathroomFanCard">
                <div style="flex-grow: 1;"> <!-- Added wrapper div -->
                    <div class="maintenance-header">
                        <div class="maintenance-icon">
                            <i class="fas fa-wind"></i>
                        </div>
                        <div>
                            <h3 class="maintenance-title">Bathroom Fan Maintenance</h3>
                        </div>
                    </div>
                    <p>Regular maintenance of bathroom fans in all rooms</p>
                    <div class="maintenance-status unknown">Unknown</div>
                    <div class="maintenance-date">No record</div>
                </div> <!-- Closed wrapper div -->
                 <div class="maintenance-footer">
                     <button class="maintenance-action print-style-btn" data-task-type="bathroom-fan">
                         <span class="printer-wrapper">
                         <span class="printer-container">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 92 75">
                             <path stroke-width="5" stroke="black" d="M12 37.5H80C85.2467 37.5 89.5 41.7533 89.5 47V69C89.5 70.933 87.933 72.5 86 72.5H6C4.067 72.5 2.5 70.933 2.5 69V47C2.5 41.7533 6.75329 37.5 12 37.5Z"></path>
                             <mask fill="white" id="print-mask-fan"><path d="M12 12C12 5.37258 17.3726 0 24 0H57C70.2548 0 81 10.7452 81 24V29H12V12Z"></path></mask>
                             <path mask="url(#print-mask-fan)" fill="black" d="M7 12C7 2.61116 14.6112 -5 24 -5H57C73.0163 -5 86 7.98374 86 24H76C76 13.5066 67.4934 5 57 5H24C20.134 5 17 8.13401 17 12H7ZM81 29H12H81ZM7 29V12C7 2.61116 14.6112 -5 24 -5V5C20.134 5 17 8.13401 17 12V29H7ZM57 -5C73.0163 -5 86 7.98374 86 24V29H76V24C76 13.5066 67.4934 5 57 5V-5Z"></path>
                             <circle fill="black" r="3" cy="49" cx="78"></circle>
                           </svg>
                         </span>
                         <span class="printer-page-wrapper">
                           <span class="printer-page"></span>
                         </span>
                       </span>
                       Mark Complete
                    </button>
                 </div>
            </div>
            
            <!-- Branch-specific actions card -->
            <div class="maintenance-card actions-card" id="branchActionsCard">
                <div class="maintenance-header">
                    <div class="maintenance-icon">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div>
                        <h3 class="maintenance-title">Branch Actions</h3>
                    </div>
                </div>
                <p>Actions specific to the selected branch</p>
                <div class="button-container">
                    <!-- Export to Excel Button -->
                    <button class="excel-button-tracking" id="exportExcelBtn">
                        <svg
                            fill="#fff"
                            xmlns="http://www.w3.org/2000/svg"
                            width="20"
                            height="20"
                            viewBox="0 0 50 50"
                        >
                            <path
                            d="M28.8125 .03125L.8125 5.34375C.339844 
                            5.433594 0 5.863281 0 6.34375L0 43.65625C0 
                            44.136719 .339844 44.566406 .8125 44.65625L28.8125 
                            49.96875C28.875 49.980469 28.9375 50 29 50C29.230469 
                            50 29.445313 49.929688 29.625 49.78125C29.855469 49.589844 
                            30 49.296875 30 49L30 1C30 .703125 29.855469 .410156 29.625 
                            .21875C29.394531 .0273438 29.105469 -.0234375 28.8125 .03125ZM32 
                            6L32 13L34 13L34 15L32 15L32 20L34 20L34 22L32 22L32 27L34 27L34 
                            29L32 29L32 35L34 35L34 37L32 37L32 44L47 44C48.101563 44 49 
                            43.101563 49 42L49 8C49 6.898438 48.101563 6 47 6ZM36 13L44 
                            13L44 15L36 15ZM6.6875 15.6875L11.8125 15.6875L14.5 21.28125C14.710938 
                            21.722656 14.898438 22.265625 15.0625 22.875L15.09375 22.875C15.199219 
                            22.511719 15.402344 21.941406 15.6875 21.21875L18.65625 15.6875L23.34375 
                            15.6875L17.75 24.9375L23.5 34.375L18.53125 34.375L15.28125 
                            28.28125C15.160156 28.054688 15.035156 27.636719 14.90625 
                            27.03125L14.875 27.03125C14.8125 27.316406 14.664063 27.761719 
                            14.4375 28.34375L11.1875 34.375L6.1875 34.375L12.15625 25.03125ZM36 
                            20L44 20L44 22L36 22ZM36 27L44 27L44 29L36 29ZM36 35L44 35L44 37L36 37Z"
                            ></path>
                        </svg>
                        Export to Excel
                    </button>
                    
                    <!-- Print View Button -->
                    <button class="print-button-tracking" id="printViewBtn">
                        <span class="printer-wrapper">
                            <span class="printer-container">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 92 75">
                                    <path
                                    stroke-width="5"
                                    stroke="black"
                                    d="M12 37.5H80C85.2467 37.5 89.5 41.7533 89.5 47V69C89.5 70.933 87.933 72.5 86 72.5H6C4.067 72.5 2.5 70.933 2.5 69V47C2.5 41.7533 6.75329 37.5 12 37.5Z"
                                    ></path>
                                    <mask fill="white" id="path-2-inside-1_30_7">
                                    <path
                                        d="M12 12C12 5.37258 17.3726 0 24 0H57C70.2548 0 81 10.7452 81 24V29H12V12Z"
                                    ></path>
                                    </mask>
                                    <path
                                    mask="url(#path-2-inside-1_30_7)"
                                    fill="black"
                                    d="M7 12C7 2.61116 14.6112 -5 24 -5H57C73.0163 -5 86 7.98374 86 24H76C76 13.5066 67.4934 5 57 5H24C20.134 5 17 8.13401 17 12H7ZM81 29H12H81ZM7 29V12C7 2.61116 14.6112 -5 24 -5V5C20.134 5 17 8.13401 17 12V29H7ZM57 -5C73.0163 -5 86 7.98374 86 24V29H76V24C76 13.5066 67.4934 5 57 5V-5Z"
                                    ></path>
                                    <circle fill="black" r="3" cy="49" cx="78"></circle>
                                </svg>
                            </span>
                            <span class="printer-page-wrapper">
                                <span class="printer-page"></span>
                            </span>
                        </span>
                        Print View
                    </button>
                    
                    <!-- Delete All Tasks Button -->
                    <button class="delete-button-tracking" id="deleteAllTasksBtn">
                        <span class="text">Delete Tasks</span>
                        <span class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                <path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path>
                            </svg>
                        </span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Filter Section Wrapper -->
        <div class="filter-wrapper">
            <!-- Button Container -->
            <div class="filter-buttons">
                <!-- Toggle Button -->
                <button type="button" id="toggleFiltersBtn" class="toggle-filters-btn">
                    <i class="fas fa-filter"></i>
                    <span>Show Filters</span>
                </button>
                
                <!-- Refresh List Button -->
                <button type="button" id="refreshListBtn" class="toggle-filters-btn">
                    <i class="fas fa-sync-alt"></i>
                    <span>Refresh List</span>
                </button>
            </div>
            
            <!-- Existing Filter Section -->
            <div class="filter-section">
                <div class="filter-grid">
                    <div class="filter-group">
                        <label for="searchInput" class="filter-label">Search</label>
                        <input type="text" id="searchInput" class="filter-input" placeholder="Search issues...">
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterCategory" class="filter-label">Category</label>
                        <select id="filterCategory" class="filter-input">
                            <option value="">All Categories</option>
                            <option value="Electrical">Electrical</option>
                            <option value="Plumbing">Plumbing</option>
                            <option value="Furniture">Furniture</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterStatus" class="filter-label">Status</label>
                        <select id="filterStatus" class="filter-input">
                            <option value="">All Statuses</option>
                            <option value="New">New</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Completed">Completed</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterPriority" class="filter-label">Priority</label>
                        <select id="filterPriority" class="filter-input">
                            <option value="">All Priorities</option>
                            <option value="low">Low</option>
                            <option value="critical">Critical</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="dateFrom" class="filter-label">From Date</label>
                        <input type="date" id="dateFrom" class="filter-input">
                    </div>
                    
                    <div class="filter-group">
                        <label for="dateTo" class="filter-label">To Date</label>
                        <input type="date" id="dateTo" class="filter-input">
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Sort Order</label>
                        <div class="sort-buttons" id="sortControlButtons">
                            <button type="button" class="sort-btn active" data-sort="desc"><i class="fas fa-sort-amount-down"></i> Newest</button>
                            <button type="button" class="sort-btn" data-sort="asc"><i class="fas fa-sort-amount-up"></i> Oldest</button>
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">&nbsp;</label>
                        <button type="button" id="clearFilters" class="clear-filters-btn"><i class="fas fa-times"></i> Clear Filters</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="issuesList" class="issues-list">
            <!-- Issues will be dynamically inserted here -->
            <div class="empty-state">
                <h3>Loading Issues...</h3>
                <p>Please wait while we retrieve the maintenance issues.</p>
            </div>
        </div>
        
        <div id="paginationContainer" class="pagination">
            <!-- Pagination will be dynamically inserted here -->
        </div>
    </div>
    
    <!-- Firebase Scripts (added defer) -->
    <script defer src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    
    <!-- Safari Navigation Fix - Must be loaded before Firebase config -->
    <script defer src="js/safari-navigation-fix.js"></script>
    
    <!-- Hide branch selector modal on tracking page -->
    <script>
        // Completely prevent branch selector modal on tracking page
        document.addEventListener('DOMContentLoaded', function() {
            // Aggressive approach to remove modal
            const removeModal = function() {
                // Hide any visible modal first
                const branchSelectorModal = document.getElementById('branchSelectorModal');
                if (branchSelectorModal) {
                    console.log('Tracking page: Found branch selector modal - removing it');
                    
                    // Hide it first
                    branchSelectorModal.style.display = 'none';
                    
                    // Then remove it from DOM
                    if (branchSelectorModal.parentNode) {
                        branchSelectorModal.parentNode.removeChild(branchSelectorModal);
                    }
                }
                
                // Also check for container
                const branchSelectorContainer = document.getElementById('branch-selector-container');
                if (branchSelectorContainer) {
                    console.log('Tracking page: Found branch selector container - removing it');
                    branchSelectorContainer.parentNode.removeChild(branchSelectorContainer);
                }
            };
            
            // Run immediately and also after delays to catch any that might be added dynamically
            removeModal();
            setTimeout(removeModal, 500);
            setTimeout(removeModal, 1000);
            setTimeout(removeModal, 2000);
            
            // Also override any functions that might show the modal
            if (window.branchSelector) {
                console.log('Tracking page: Overriding branch selector functions');
                // Override show function
                if (typeof window.branchSelector.showBranchSelector === 'function') {
                    const originalShow = window.branchSelector.showBranchSelector;
                    window.branchSelector.showBranchSelector = function() {
                        console.log('Tracking page: Blocked attempt to show branch selector');
                        return false;
                    };
                }
            }
        });
    </script>
    
    <!-- Include firebase config (added defer) -->
    <script defer src="js/firebase-config.js"></script>
    
    <!-- Core Scripts (added defer) -->
    <script defer src="js/hotel-branch-manager.js"></script>
    <script defer src="js/branch-selector.js"></script>
    
    <!-- New tracking script (added defer) -->
    <script defer src="js/tracking-new.js"></script>

    <!-- Choices.js JS (added defer) -->
    <script defer src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

    <!-- Filter Toggle Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const toggleBtn = document.getElementById('toggleFiltersBtn');
            const filterSection = document.querySelector('.filter-section');
            const filterWrapper = document.querySelector('.filter-wrapper');
            const btnIcon = toggleBtn.querySelector('i');
            const btnText = toggleBtn.querySelector('span');
            const filterGrid = document.querySelector('.filter-grid');
            
            // Calculate actual filter height for proper spacing
            function updateSpacing(isExpanded) {
                if (isExpanded) {
                    // Get actual height of expanded filter section 
                    setTimeout(() => {
                        const filterHeight = filterSection.offsetHeight;
                        document.documentElement.style.setProperty('--filter-height', `${filterHeight}px`);
                    }, 50); // Small delay to let the DOM update
                } else {
                    document.documentElement.style.setProperty('--filter-height', '0px');
                }
            }

            if (toggleBtn && filterSection && btnIcon && btnText) {
                toggleBtn.addEventListener('click', () => {
                    const isExpanded = !filterSection.classList.contains('expanded');
                    
                    if (isExpanded) {
                        // Expanding the filter section
                        filterSection.classList.add('expanded');
                        toggleBtn.classList.add('expanded');
                        btnText.textContent = 'Hide Filters';
                        
                        // Show grid after a short delay to ensure it's visible
                        setTimeout(() => {
                            filterGrid.style.display = 'grid';
                            updateSpacing(true);
                        }, 10);
                        
                        // Create space for content below filter section
                        filterWrapper.style.marginBottom = 'var(--filter-height)';
                    } else {
                        // Collapsing the filter section
                        filterSection.classList.remove('expanded');
                        toggleBtn.classList.remove('expanded');
                        btnText.textContent = 'Show Filters';
                        updateSpacing(false);
                        
                        // Reset margin on collapse
                        filterWrapper.style.marginBottom = '15px';
                        
                        // Hide grid immediately
                        setTimeout(() => {
                            filterGrid.style.display = 'none';
                        }, 300); // Wait for transition to complete
                    }
                });
            } else {
                console.error('Filter toggle button or section not found.');
            }
        });
    </script>
</body>
</html> 